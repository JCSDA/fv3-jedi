geometry:
  fms initialization:
    namelist filename: Data/fv3files/fmsmpp.nml
    field table filename: Data/fv3files/field_table
  akbk: Data/fv3files/akbk64.nc4
  npx: 13
  npy: 13
  npz: 64
  fieldsets:
    - fieldset: Data/fieldsets/dynamics.yaml
    - fieldset: Data/fieldsets/ufo.yaml

window begin: &date 2018-04-14T21:00:00Z
window length: PT6H

background:
 date: *date
 members:
   - datetime: 2018-04-15T00:00:00Z
     filetype: fms restart
     state variables: [ua,va,T,DELP,sphum,ice_wat,liq_wat,o3mr]
     datapath: Data/inputs/gfs_c12/mem001/
     filename_core: 20180415.000000.fv_core.res.nc
     filename_trcr: 20180415.000000.fv_tracer.res.nc
     filename_sfcd: 20180415.000000.sfc_data.nc
     filename_sfcw: 20180415.000000.fv_srf_wnd.res.nc
     filename_cplr: 20180415.000000.coupler.res
   - datetime: 2018-04-15T00:00:00Z
     filetype: fms restart
     state variables: [ua,va,T,DELP,sphum,ice_wat,liq_wat,o3mr]
     datapath: Data/inputs/gfs_c12/mem002/
     filename_core: 20180415.000000.fv_core.res.nc
     filename_trcr: 20180415.000000.fv_tracer.res.nc
     filename_sfcd: 20180415.000000.sfc_data.nc
     filename_sfcw: 20180415.000000.fv_srf_wnd.res.nc
     filename_cplr: 20180415.000000.coupler.res
   - datetime: 2018-04-15T00:00:00Z
     filetype: fms restart
     state variables: [ua,va,T,DELP,sphum,ice_wat,liq_wat,o3mr]
     datapath: Data/inputs/gfs_c12/mem003/
     filename_core: 20180415.000000.fv_core.res.nc
     filename_trcr: 20180415.000000.fv_tracer.res.nc
     filename_sfcd: 20180415.000000.sfc_data.nc
     filename_sfcw: 20180415.000000.fv_srf_wnd.res.nc
     filename_cplr: 20180415.000000.coupler.res
   - datetime: 2018-04-15T00:00:00Z
     filetype: fms restart
     state variables: [ua,va,T,DELP,sphum,ice_wat,liq_wat,o3mr]
     datapath: Data/inputs/gfs_c12/mem004/
     filename_core: 20180415.000000.fv_core.res.nc
     filename_trcr: 20180415.000000.fv_tracer.res.nc
     filename_sfcd: 20180415.000000.sfc_data.nc
     filename_sfcw: 20180415.000000.fv_srf_wnd.res.nc
     filename_cplr: 20180415.000000.coupler.res
   - datetime: 2018-04-15T00:00:00Z
     filetype: fms restart
     state variables: [ua,va,T,DELP,sphum,ice_wat,liq_wat,o3mr]
     datapath: Data/inputs/gfs_c12/mem005/
     filename_core: 20180415.000000.fv_core.res.nc
     filename_trcr: 20180415.000000.fv_tracer.res.nc
     filename_sfcd: 20180415.000000.sfc_data.nc
     filename_sfcw: 20180415.000000.fv_srf_wnd.res.nc
     filename_cplr: 20180415.000000.coupler.res
   - datetime: 2018-04-15T00:00:00Z
     filetype: fms restart
     state variables: [ua,va,T,DELP,sphum,ice_wat,liq_wat,o3mr]
     datapath: Data/inputs/gfs_c12/mem006/
     filename_core: 20180415.000000.fv_core.res.nc
     filename_trcr: 20180415.000000.fv_tracer.res.nc
     filename_sfcd: 20180415.000000.sfc_data.nc
     filename_sfcw: 20180415.000000.fv_srf_wnd.res.nc
     filename_cplr: 20180415.000000.coupler.res
   - datetime: 2018-04-15T00:00:00Z
     filetype: fms restart
     state variables: [ua,va,T,DELP,sphum,ice_wat,liq_wat,o3mr]
     datapath: Data/inputs/gfs_c12/mem007/
     filename_core: 20180415.000000.fv_core.res.nc
     filename_trcr: 20180415.000000.fv_tracer.res.nc
     filename_sfcd: 20180415.000000.sfc_data.nc
     filename_sfcw: 20180415.000000.fv_srf_wnd.res.nc
     filename_cplr: 20180415.000000.coupler.res
   - datetime: 2018-04-15T00:00:00Z
     filetype: fms restart
     state variables: [ua,va,T,DELP,sphum,ice_wat,liq_wat,o3mr]
     datapath: Data/inputs/gfs_c12/mem008/
     filename_core: 20180415.000000.fv_core.res.nc
     filename_trcr: 20180415.000000.fv_tracer.res.nc
     filename_sfcd: 20180415.000000.sfc_data.nc
     filename_sfcw: 20180415.000000.fv_srf_wnd.res.nc
     filename_cplr: 20180415.000000.coupler.res
   - datetime: 2018-04-15T00:00:00Z
     filetype: fms restart
     state variables: [ua,va,T,DELP,sphum,ice_wat,liq_wat,o3mr]
     datapath: Data/inputs/gfs_c12/mem009/
     filename_core: 20180415.000000.fv_core.res.nc
     filename_trcr: 20180415.000000.fv_tracer.res.nc
     filename_sfcd: 20180415.000000.sfc_data.nc
     filename_sfcw: 20180415.000000.fv_srf_wnd.res.nc
     filename_cplr: 20180415.000000.coupler.res
   - datetime: 2018-04-15T00:00:00Z
     filetype: fms restart
     state variables: [ua,va,T,DELP,sphum,ice_wat,liq_wat,o3mr]
     datapath: Data/inputs/gfs_c12/mem010/
     filename_core: 20180415.000000.fv_core.res.nc
     filename_trcr: 20180415.000000.fv_tracer.res.nc
     filename_sfcd: 20180415.000000.sfc_data.nc
     filename_sfcw: 20180415.000000.fv_srf_wnd.res.nc
     filename_cplr: 20180415.000000.coupler.res

observations:
- obs space:
    name: Radiosonde
    distribution: Halo
    obsdatain:
      obsfile: Data/obs/testinput_tier_1/scatwind_obs_2018041500_s.nc4
#    obsdataout:
#      obsfile: Data/analysis/letkf/gfs/scatwind_obs_2018041500_s.nc4
    #simulated variables: [eastward_wind, northward_wind, air_temperature]
    simulated variables: [eastward_wind, northward_wind]
  obs operator:
    name: VertInterp
  obs error:
    covariance model: diagonal
  obs localizations:
  - localization method: Horizontal Gaspari-Cohn
    lengthscale: 5000e3
    max nobs: 1000

driver:
  update obs config with geometry info: true
  save posterior ensemble: false
  save posterior mean increment: false

local ensemble DA:
  solver: LETKF
  inflation:
    rtps: 0.5
    rtpp: 0.6
    mult: 1.1

output:
  filetype: latlon
  filename: Data/analysis/letkf/gfs/mem%{member}%/letkf.

output increment:
  filetype: latlon
  filename: Data/analysis/letkf/gfs/mem%{member}%/xainc.

test:
  reference filename: testoutput/letkf.ref
  float relative tolerance: 1.0e-2
  test output filename: testoutput/letkf.test.out
